<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance.Bot | Minimal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');
        body { 
            background-color: #000000; 
            font-family: 'Inter', sans-serif;
            color: #ffffff;
            -webkit-font-smoothing: antialiased;
        }
        .msg-appear { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="h-screen flex flex-col selection:bg-white selection:text-black">

    <header class="w-full max-w-3xl mx-auto px-6 py-8 flex justify-between items-end">
        <div>
            <h1 class="text-xl font-semibold tracking-wide uppercase">Finance.Bot</h1>
            <p class="text-xs text-neutral-500 mt-1">Local Database: <span class="text-white">Active</span></p>
        </div>
        <div class="text-right">
            <p class="text-xs text-neutral-500 uppercase tracking-widest mb-1">Total</p>
            <p id="total-display" class="text-3xl font-light">$0.00</p>
        </div>
    </header>

    <main id="messages" class="flex-1 w-full max-w-3xl mx-auto px-6 overflow-y-auto space-y-8 pb-32">
        </main>

    <footer class="fixed bottom-0 w-full bg-gradient-to-t from-black via-black to-transparent pt-12 pb-8">
        <div class="max-w-3xl mx-auto px-6">
            
            <div class="flex gap-6 mb-4">
                <button onclick="runCmd('/add')" class="text-xs text-neutral-500 hover:text-white transition-colors uppercase tracking-widest">/Add</button>
                <button onclick="runCmd('/history')" class="text-xs text-neutral-500 hover:text-white transition-colors uppercase tracking-widest">/History</button>
                <button onclick="runCmd('/clear')" class="text-xs text-neutral-500 hover:text-white transition-colors uppercase tracking-widest">/Clear</button>
            </div>

            <div class="flex items-center border-b border-neutral-800 pb-2">
                <span class="text-neutral-500 mr-3">></span>
                <input type="text" id="user-input" 
                    class="flex-1 bg-transparent text-white text-lg outline-none placeholder-neutral-700 font-light w-full"
                    placeholder="Type a command..."
                    onkeypress="if(event.key === 'Enter') handleInput()"
                    autofocus>
            </div>

        </div>
    </footer>

    <script>
        let expenses = JSON.parse(localStorage.getItem('financeData')) || [];
        let state = "IDLE";
        let temp = {};

        window.onload = () => {
            updateTotal();
            addMessage("System ready. Type /add to begin or /history to view past entries.");
            if(expenses.length > 0) {
                setTimeout(() => addMessage(`Loaded ${expenses.length} previous records from local database.`), 400);
            }
        };

        function addMessage(text, isBot = true) {
            const container = document.getElementById('messages');
            const wrapper = document.createElement('div');
            wrapper.className = "msg-appear";
            
            const label = isBot ? "Bot" : "You";
            const color = isBot ? "text-neutral-500" : "text-neutral-300";

            wrapper.innerHTML = `
                <p class="${color} text-[10px] uppercase tracking-widest mb-1">${label}</p>
                <p class="text-white text-lg font-light leading-relaxed">${text}</p>
            `;
            
            container.appendChild(wrapper);
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }

        function runCmd(cmd) {
            document.getElementById('user-input').value = cmd;
            document.getElementById('user-input').focus();
            handleInput();
        }

        function updateTotal() {
            const sum = expenses.reduce((a, b) => a + b.amount, 0);
            document.getElementById('total-display').innerText = `$${sum.toFixed(2)}`;
            
            localStorage.setItem('financeData', JSON.stringify(expenses));
        }

        function handleInput() {
            const input = document.getElementById('user-input');
            const val = input.value.trim();
            if (!val) return;

            addMessage(val, false);
            input.value = "";
            processLogic(val.toLowerCase());
        }

        function processLogic(val) {
            if (state === "IDLE") {
                if (val === "add" || val === "/add") {
                    setTimeout(() => addMessage("What is the description of the expense?"), 300);
                    state = "ASK_TITLE";
                } else if (val === "history" || val === "/history") {
                    if (expenses.length === 0) return setTimeout(() => addMessage("No records found in database."), 300);
                    let list = expenses.map(e => `${e.title}: $${e.amount}`).join('<br>');
                    setTimeout(() => addMessage(`History:<br>${list}`), 300);
                } else if (val === "clear" || val === "/clear") {
                    expenses = [];
                    localStorage.removeItem('financeData');
                    updateTotal();
                    document.getElementById('messages').innerHTML = "";
                    setTimeout(() => addMessage("Database wiped. Starting fresh."), 300);
                } else {
                    setTimeout(() => addMessage("Unknown command. Use /add, /history, or /clear."), 300);
                }
            } else if (state === "ASK_TITLE") {
                temp.title = val;
                setTimeout(() => addMessage(`Enter the cost for "${val}".`), 300);
                state = "ASK_AMOUNT";
            } else if (state === "ASK_AMOUNT") {
                const amt = parseFloat(val);
                if (isNaN(amt)) {
                    setTimeout(() => addMessage("Please enter a valid number."), 300);
                } else {
                    temp.amount = amt;
                    expenses.push({...temp});
                    updateTotal(); 
                    setTimeout(() => addMessage(`Logged: $${amt}. Database updated.`), 300);
                    state = "IDLE";
                    temp = {};
                }
            }
        }
    </script>
</body>
</html>